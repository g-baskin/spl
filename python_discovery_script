#!/usr/bin/env python3
import subprocess
import sys

# HARDCODED - Edit these values
HOST = '100.1.1.1'
PORT = 37422
USER = 'c_X_logs'
PASS = 'your_password_here'
DIR = '/shared_Xlogs'

try:
    # SFTP commands
    sftp_cmd = f"""cd {DIR}
ls -1
bye
"""
    
    # Run SFTP with sshpass
    result = subprocess.run(
        ['sshpass', '-p', PASS, 'sftp', '-P', str(PORT), '-o', 'StrictHostKeyChecking=no', '-b', '-', f'{USER}@{HOST}'],
        input=sftp_cmd,
        capture_output=True,
        text=True
    )
    
    # DEBUG: Print everything we got back
    print("=== DEBUG: Return Code ===")
    print(result.returncode)
    
    print("\n=== DEBUG: STDOUT ===")
    print(repr(result.stdout))
    
    print("\n=== DEBUG: STDERR ===")
    print(repr(result.stderr))
    
    print("\n=== DEBUG: Split Lines ===")
    lines = result.stdout.strip().split('\n')
    for i, line in enumerate(lines):
        print(f"Line {i}: {repr(line)}")
    
    print("\n=== ACTUAL OUTPUT (.log files only) ===")
    # Print only .log files (one per line)
    for line in result.stdout.strip().split('\n'):
        if line.endswith('.log'):
            print(line)
            
except Exception as e:
    sys.stderr.write(f"Error: {e}\n")
    sys.exit(1)
